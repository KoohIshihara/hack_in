page-account
  div.wrap-page.py48
    div.wrap-profile
      div.wrap-icon
        img(src='{iconSrc}')
        p.name {this.name}
      


  style(scoped, type='less').
    @import "public/stylesheets/main.less";
    @import "public/stylesheets/theme.less";
    :scope {
      .wrap-page {
        padding: 48px 0px;
        width: 100%;
        height: 100%;
        background: @primaryBg;
      }
    }

  script.
    
    var self = this;

    this.on('mount', function(){
      $('modal-content').addClass('show');
      $('modal-content').scrollTop(0);

      // 次の画面遷移時にフェードインを防止
      riot.enableFadeIn = false;

      $(document).on("custom:close", function() {
        $('modal-content').removeClass('show');
        self.unmount(true);
      });

      riot.enableReloadContent = false;

    });

    var uid = opts.__proto__.uid;

    if(uid){
      service.db.collection("users")
        .where("uid", "==", uid)
        .limit(1)
        .get()
        .then(function(querySnapshot) {
          querySnapshot.forEach(function(doc) {
            //console.log(doc.uid, " => ", doc.data());
            var user;
            if(doc.data().uid == uid){ 
              user = doc.data();
              self.iconSrc = user.imgUrl;
              self.name = user.name;
              self.profile = user.profile;
              self.update();
            }
          });

      }).catch(function(error) {
        console.log("Error getting documents: ", error);
      });
    }